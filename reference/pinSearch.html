<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Search for noninvariant parameters across groups. — pinSearch • pinsearch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Search for noninvariant parameters across groups. — pinSearch"><meta name="description" content="The function implements the sequential selection method similar to
that discussed in
Yoon and Millsap (2007).
The function proceeds in the order of metric, scalar (threshold),
and strict invariance. In each stage, invariance constraints in all
items, and the constraint associated with the biggest test
statistic above a predefined threshold is freed, before recomputing
the test statistic for the next constraint to free."><meta property="og:description" content="The function implements the sequential selection method similar to
that discussed in
Yoon and Millsap (2007).
The function proceeds in the order of metric, scalar (threshold),
and strict invariance. In each stage, invariance constraints in all
items, and the constraint associated with the biggest test
statistic above a predefined threshold is freed, before recomputing
the test statistic for the next constraint to free."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pinsearch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pinsearch.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/compare-cont-cat.html">Comparing Effect Size for Continuous and Categorical Data</a></li>
    <li><a class="dropdown-item" href="../articles/contrast.html">Using Contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/dmacs-ci.html">Confidence Intervals for dMACS</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/marklhc/pinsearch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Search for noninvariant parameters across groups.</h1>
      <small class="dont-index">Source: <a href="https://github.com/marklhc/pinsearch/blob/master/R/pinSearch.R" class="external-link"><code>R/pinSearch.R</code></a></small>
      <div class="d-none name"><code>pinSearch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function implements the sequential selection method similar to
that discussed in
<a href="https://doi.org/10.1080/10705510701301677" class="external-link">Yoon and Millsap (2007)</a>.
The function proceeds in the order of metric, scalar (threshold),
and strict invariance. In each stage, invariance constraints in all
items, and the constraint associated with the biggest test
statistic above a predefined threshold is freed, before recomputing
the test statistic for the next constraint to free.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pinSearch</span><span class="op">(</span></span>
<span>  <span class="va">config_mod</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span>, <span class="st">"thresholds"</span>, <span class="st">"residuals"</span>, <span class="st">"residual.covariances"</span><span class="op">)</span>,</span>
<span>  inv_test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mod"</span>, <span class="st">"score"</span>, <span class="st">"lrt"</span><span class="op">)</span>,</span>
<span>  sig_level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  control_fdr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  effect_size <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-config-mod">config_mod<a class="anchor" aria-label="anchor" href="#arg-config-mod"></a></dt>
<dd><p>Syntax of a configural invariance model to be passed to
<code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additonal arguments passed to <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character variable indicating the stage of invariance to be
searched. Currently supported options are (a) for continuous indicators,
"loadings", "intercepts", "residuals", and "residual.covariances", and
(b) "loadings", "thresholds", "residual.covariances", in an increasingly
strict order. A stricter model (e.g., "residual.covariances") will have
constraints of all previous stages.</p></dd>


<dt id="arg-inv-test">inv_test<a class="anchor" aria-label="anchor" href="#arg-inv-test"></a></dt>
<dd><p>Character variable indicating the statistical test to be
used for specification search. Currently supported options are <code>"mod"</code> for
modification index using <code><a href="https://rdrr.io/pkg/lavaan/man/modificationIndices.html" class="external-link">lavaan::modindices()</a></code>, <code>"score"</code> for score
test statistic using <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestScore.html" class="external-link">lavaan::lavTestScore()</a></code>, and (experimental) <code>"lrt"</code>
for likelihood ratio test statistic using <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code>.</p></dd>


<dt id="arg-sig-level">sig_level<a class="anchor" aria-label="anchor" href="#arg-sig-level"></a></dt>
<dd><p>Significance level used to determine whether the parameter
associated with the highest modification index should be removed. Default
is .05.</p></dd>


<dt id="arg-control-fdr">control_fdr<a class="anchor" aria-label="anchor" href="#arg-control-fdr"></a></dt>
<dd><p>Logical; whether to use adjust for false discovery rate
for multiple testing. If <code>TRUE</code>, the method by Benjamini &amp; Gavrilov (2009)
will be used.</p></dd>


<dt id="arg-effect-size">effect_size<a class="anchor" aria-label="anchor" href="#arg-effect-size"></a></dt>
<dd><p>Logical; whether to compute dmacs (two groups) or
fmacs (&gt; two groups) effect size or not (default).
This is an experimental feature.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical; an experimental feature of showing a progress bar
if <code>TRUE</code>. Because the number of steps is unknown until the stopping
criteria are reached, the progress bar may be inaccurate.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of three elements:</p><ul><li><p><code>Partial Invariance Fit</code>: A <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan-class.html" class="external-link">lavaan::lavaan</a></code>
object containing the final partial invariance model.</p></li>
<li><p><code>Non-Invariant Items</code>: A data frame of non-invariant
parameters.</p></li>
<li><p><code>effect_size</code>: Effect size statistics obtained from
<code><a href="es_lavaan.html">pin_effsize()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that when an item has a non-invariant loading, the
corresponding intercept constraint will automatically be freed,
as intercept difference across groups is sensitive to the location
of the zero point for the latent variable and the item.</p>
<p>For a particular stage of invariance constraints, the Benjamini &amp;
Gavrilov method uses an adjusted \(alpha\) level of
$$iq / [m + 1 - i(1 - q)]$$
where \(i\) is the step index in the search, \(m\) is the
maximum number of constraints that can be freed, and \(q\) is
the desirable significance level.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Yoon, M., &amp; Millsap, R. E. (2007). Detecting violations of
factorial invariance using data-based specification searches: A
Monte Carlo study. Structural Equation Modeling: A Multidisciplinary
Journal, 14(3), 435-463.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is lavaan 0.6-19</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> lavaan is FREE software! Please report any bugs.</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Simulate random data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">14</span><span class="op">)</span> <span class="co"># for reproducible results</span></span></span>
<span class="r-in"><span><span class="va">mod_ninv</span> <span class="op">&lt;-</span> <span class="st">"f =~ c(1, 0.8, .6)*y1 + c(0.8, 1.2, 1.0)*y2"</span></span></span>
<span class="r-in"><span><span class="va">mod_inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"1*y"</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">mod_ninv</span>, <span class="st">"+"</span>, <span class="va">mod_inv</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"f ~~ c(1, 1.3, 1.5)*f</span></span></span>
<span class="r-in"><span><span class="st">     f ~ c(0, 0.5, 1.0)*1</span></span></span>
<span class="r-in"><span><span class="st">     y1 ~ c(0, 0.3, 0)*1</span></span></span>
<span class="r-in"><span><span class="st">     y3 ~ c(0.3, 0, -0.3)*1</span></span></span>
<span class="r-in"><span><span class="st">     y1 ~~ c(1, .5, 1)*y1"</span>,</span></span>
<span class="r-in"><span>    sep <span class="op">=</span> <span class="st">"\n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The uniqueness of each item is assumed to be 1.0</span></span></span>
<span class="r-in"><span><span class="va">dat_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html" class="external-link">simulateData</a></span><span class="op">(</span><span class="va">sim_mod</span>, sample.nobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit configural model:</span></span></span>
<span class="r-in"><span><span class="va">sam_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"f =~ "</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pinSearch</span><span class="op">(</span><span class="va">sam_config</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">dat_sim</span>, group <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="st">"intercepts"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Partial Invariance Fit`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lavaan 0.6-19 ended normally after 60 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Estimator                                         ML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Optimization method                           NLMINB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of model parameters                        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of equality constraints                    19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of observations per group:                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1                                              100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2                                              100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3                                              100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Test User Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test statistic                                47.688</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Degrees of freedom                                42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P-value (Chi-square)                           0.252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test statistic for each group:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1                                           12.480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2                                           20.956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3                                           14.252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Non-Invariant Items`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   group lhs rhs       type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1   f  y1   loadings</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1  y3     intercepts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3  y1     intercepts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2  y3     intercepts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mark Lai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

