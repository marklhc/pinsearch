<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The function implements the sequential selection method similar to
that discussed in
Yoon and Millsap (2007).
The function proceeds in the order of metric, scalar (threshold),
and strict invariance. In each stage, invariance constraints in all
items, and the constraint associated with the biggest test
statistic above a predefined threshold is freed, before recomputing
the test statistic for the next constraint to free."><title>Search for noninvariant parameters across groups. — pinSearch • pinsearch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Search for noninvariant parameters across groups. — pinSearch"><meta property="og:description" content="The function implements the sequential selection method similar to
that discussed in
Yoon and Millsap (2007).
The function proceeds in the order of metric, scalar (threshold),
and strict invariance. In each stage, invariance constraints in all
items, and the constraint associated with the biggest test
statistic above a predefined threshold is freed, before recomputing
the test statistic for the next constraint to free."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pinsearch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/pinsearch.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/compare-cont-cat.html">Comparing Effect Size for Continuous and Categorical Data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/marklhc/pinsearch/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Search for noninvariant parameters across groups.</h1>
      <small class="dont-index">Source: <a href="https://github.com/marklhc/pinsearch/blob/HEAD/R/pinSearch.R" class="external-link"><code>R/pinSearch.R</code></a></small>
      <div class="d-none name"><code>pinSearch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function implements the sequential selection method similar to
that discussed in
<a href="https://doi.org/10.1080/10705510701301677" class="external-link">Yoon and Millsap (2007)</a>.
The function proceeds in the order of metric, scalar (threshold),
and strict invariance. In each stage, invariance constraints in all
items, and the constraint associated with the biggest test
statistic above a predefined threshold is freed, before recomputing
the test statistic for the next constraint to free.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pinSearch</span><span class="op">(</span></span>
<span>  <span class="va">config_mod</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ordered <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parameterization <span class="op">=</span> <span class="st">"theta"</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span>, <span class="st">"thresholds"</span>, <span class="st">"residuals"</span>, <span class="st">"residual.covariances"</span><span class="op">)</span>,</span>
<span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mod"</span>, <span class="st">"score"</span><span class="op">)</span>,</span>
<span>  sig_level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  control_fdr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  effect_size <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>config_mod</dt>
<dd><p>Syntax of a configural invariance model to be passed to
<code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>.</p></dd>


<dt>data</dt>
<dd><p>A data frame to be passed to <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>.</p></dd>


<dt>group</dt>
<dd><p>Character indicating the variable name in <code>data</code> that
defines the grouping variable in multiple-group CFA.</p></dd>


<dt>ordered</dt>
<dd><p>Character vector indicating names of variables to be treated
as binary or ordinal. IF <code>NULL</code>, all items are treated as continuous.</p></dd>


<dt>parameterization</dt>
<dd><p>Character, either "theta" or "delta". "theta" should
be used for invariance testing, and is the only method tested.</p></dd>


<dt>...</dt>
<dd><p>Additonal arguments passed to <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>.</p></dd>


<dt>type</dt>
<dd><p>Character variable indicating the stage of invariance to be
searched. Currently supported options are (a) for continuous indicators,
"loadings", "intercepts", "residuals", and "residual.covariances", and
(b) "loadings", "thresholds", "residual.covariances", in an increasingly
strict order. A stricter model (e.g., "residual.covariances") will have
constraints of all previous stages.</p></dd>


<dt>test</dt>
<dd><p>Character variable indicating the statistical test to be used
for specification search. Currently supported options are <code>"mod"</code> for
modification index using <code><a href="https://rdrr.io/pkg/lavaan/man/modificationIndices.html" class="external-link">lavaan::modindices()</a></code> and <code>"score"</code> for score
test statistic using <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestScore.html" class="external-link">lavaan::lavTestScore()</a></code>.</p></dd>


<dt>sig_level</dt>
<dd><p>Significance level used to determine whether the parameter
associated with the highest modification index should be removed. Default
is .05.</p></dd>


<dt>control_fdr</dt>
<dd><p>Logical; whether to use adjust for false discovery rate
for multiple testing. If <code>TRUE</code>, the method by Benjamini &amp; Gavrilov (2009)
will be used.</p></dd>


<dt>effect_size</dt>
<dd><p>Logical; whether to compute dmacs (two groups) or
fmacs (&gt; two groups) effect size or not (default).
This is an experimental feature.</p></dd>


<dt>progress</dt>
<dd><p>Logical; an experimental feature of showing a progress bar
if <code>TRUE</code>. Because the number of steps is unknown until the stopping
criteria are reached, the progress bar may be inaccurate.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list of three elements:</p><ul><li><p><code>Partial Invariance Fit</code>A <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan-class.html" class="external-link">lavaan::lavaan</a></code>
object containing the final partial invariance model.</p></li>
<li><p><code>Non-Invariant Items</code>A data frame of non-invariant
parameters.</p></li>
<li><p><code>effect_size</code>Effect size statistics obtained from
<code><a href="es_lavaan.html">pin_es()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that when an item has a non-invariant loading, the
corresponding intercept constraint will automatically be freed,
as intercept difference across groups is sensitive to the location
of the zero point for the latent variable and the item.</p>
<p>For a particular stage of invariance constraints, the Benjamini &amp;
Gavrilov method uses an adjusted \(alpha\) level of
$$iq / [m + 1 - i(1 - q)]$$
where \(i\) is the step index in the search, \(m\) is the
maximum number of constraints that can be freed, and \(q\) is
the desirable significance level.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Yoon, M., &amp; Millsap, R. E. (2007). Detecting violations of
factorial invariance using data-based specification searches: A
Monte Carlo study. Structural Equation Modeling: A Multidisciplinary
Journal, 14(3), 435-463.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is lavaan 0.6-17</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> lavaan is FREE software! Please report any bugs.</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Simulate random data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">14</span><span class="op">)</span>  <span class="co"># for reproducible results</span></span></span>
<span class="r-in"><span><span class="va">mod_ninv</span> <span class="op">&lt;-</span> <span class="st">"f =~ c(1, 0.8, .6)*y1 + c(0.8, 1.2, 1.0)*y2"</span></span></span>
<span class="r-in"><span><span class="va">mod_inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"1*y"</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">mod_ninv</span>, <span class="st">"+"</span>, <span class="va">mod_inv</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"f ~~ c(1, 1.3, 1.5)*f</span></span></span>
<span class="r-in"><span><span class="st">     f ~ c(0, 0.5, 1.0)*1</span></span></span>
<span class="r-in"><span><span class="st">     y1 ~ c(0, 0.3, 0)*1</span></span></span>
<span class="r-in"><span><span class="st">     y3 ~ c(0.3, 0, -0.3)*1</span></span></span>
<span class="r-in"><span><span class="st">     y1 ~~ c(1, .5, 1)*y1"</span>,</span></span>
<span class="r-in"><span>    sep <span class="op">=</span> <span class="st">"\n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The uniqueness of each item is assumed to be 1.0</span></span></span>
<span class="r-in"><span><span class="va">dat_sim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/simulateData.html" class="external-link">simulateData</a></span><span class="op">(</span><span class="va">sim_mod</span>, sample.nobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit configural model:</span></span></span>
<span class="r-in"><span><span class="va">sam_config</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'f =~ '</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pinSearch</span><span class="op">(</span><span class="va">sam_config</span>, data <span class="op">=</span> <span class="va">dat_sim</span>, group <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>          type <span class="op">=</span> <span class="st">"intercepts"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>lavaan WARNING: the modindices() function ignores equality constraints;</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 		  use lavTestScore() to assess the impact of releasing one </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 		  or multiple constraints</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>lavaan WARNING: the modindices() function ignores equality constraints;</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 		  use lavTestScore() to assess the impact of releasing one </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> 		  or multiple constraints</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Partial Invariance Fit`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lavaan 0.6.17 ended normally after 55 iterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Estimator                                         ML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Optimization method                           NLMINB</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of model parameters                        58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of equality constraints                    23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Number of observations per group:                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1                                              100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2                                              100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3                                              100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Test User Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test statistic                                55.735</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Degrees of freedom                                46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P-value (Chi-square)                           0.154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test statistic for each group:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1                                           23.938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2                                           15.880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3                                           15.917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Non-Invariant Items`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lhs rhs group       type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  y1         2 intercepts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mark Lai.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

